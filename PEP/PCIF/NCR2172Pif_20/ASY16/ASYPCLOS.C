/*
*===========================================================================
* Title       : Close Function
* Category    : Asynchornous Driver for PC, NCR 2170 Operating System
* Program Name: ASYPCLOS.C
* --------------------------------------------------------------------------
* Compiler    : MS-C Ver. 7.00 by Microsoft Corp.
* Memory Model: Medium Model
* Options     : /c /Asfw /W4 /G2s /Zp
* --------------------------------------------------------------------------
* Abstract:
*
* --------------------------------------------------------------------------
* Update Histories
*    Date  :Ver.Rev.:   Name    : Description
* Jul-28-92:00.00.01:O.Nakada   : Initial
*          :        :           :
*===========================================================================
*===========================================================================
* PVCS Entry
* --------------------------------------------------------------------------
* $Revision$
* $Date$
* $Author$
* $Log$
*===========================================================================
*/


/*
*===========================================================================
*   Include File Declarations
*===========================================================================
*/
#include <conf.h>
#include <kernel.h>
#include "asy.h"


/*                                                                                
*===========================================================================
*   Compile Message Declarations
*===========================================================================
*/


/*                                                                                
*===========================================================================
*   Work Area Declarations
*===========================================================================
*/
/*
*===========================================================================
*   Public Work Area
*===========================================================================
*/


/*
*===========================================================================
*   Static Work Area 
*===========================================================================
*/


/*
*===========================================================================
*   Code Area Declarations
*===========================================================================
*/
/*
*===========================================================================
** Synopsis:    SHORT AsyClose(DEVICE *pDevTbl)
*     Input:    pDevTbl - Device Table
*
** Return:      OK     - Successful
*               SYSERR - System Error
*
** Description:
*===========================================================================
*/
SHORT AsyClose(DEVICE *pDevTbl)
{
    SHORT sStatus;

    if (!(AsyData.fchStatus & ASY_OPEN)) {  /* Already Closed */
        return (SYSERR);    
    }

    /* Close SIO Driver */
    if ((sStatus = XinuClose(AsyData.hsSio)) == OK) {
        AsyData.fchStatus &= ~ASY_OPEN;     /* Close ASY Driver */
    }

    return (sStatus);

    pDevTbl = pDevTbl;                      /* Just Refer pDevTbl */
}

